"use strict";(self.webpackChunkgo_feature_flag_website=self.webpackChunkgo_feature_flag_website||[]).push([[57960],{41420:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>i,default:()=>h,frontMatter:()=>l,metadata:()=>a,toc:()=>o});var r=t(85893),s=t(11151);const l={sidebar_position:30},i="Configure a flag",a={id:"flag_format",title:"Configure a flag",description:"go-feature-flag core feature is to centralize all your feature flags in a source file, and to avoid hosting and maintaining a backend server to manage them.",source:"@site/versioned_docs/version-v0.28.2/flag_format.md",sourceDirName:".",slug:"/flag_format",permalink:"/docs/v0.28.2/flag_format",draft:!1,unlisted:!1,editUrl:"https://github.com/thomaspoignant/go-feature-flag/tree/main/website/versioned_docs/version-v0.28.2/flag_format.md",tags:[],version:"v0.28.2",sidebarPosition:30,frontMatter:{sidebar_position:30},sidebar:"tutorialSidebar",previous:{title:"Configuration",permalink:"/docs/v0.28.2/configuration"},next:{title:"Store your flag file",permalink:"/docs/v0.28.2/flag_file/"}},d={},o=[{value:"Editor",id:"editor",level:2},{value:"Example",id:"example",level:2},{value:"YAML",id:"yaml",level:3},{value:"JSON",id:"json",level:3},{value:"TOML",id:"toml",level:3},{value:"Format details",id:"format-details",level:2},{value:"Rule format",id:"rule-format",level:2},{value:"Examples",id:"examples",level:3},{value:"Environments",id:"environments",level:2},{value:"Advanced configurations",id:"advanced-configurations",level:2}];function c(e){const n={a:"a",br:"br",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.a)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h1,{id:"configure-a-flag",children:"Configure a flag"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"go-feature-flag"})," core feature is to centralize all your feature flags in a source file, and to avoid hosting and maintaining a backend server to manage them."]}),"\n",(0,r.jsxs)(n.p,{children:["Your file must be a valid ",(0,r.jsx)(n.code,{children:"YAML"}),", ",(0,r.jsx)(n.code,{children:"JSON"})," or ",(0,r.jsx)(n.code,{children:"TOML"})," file with a list of flags\n",(0,r.jsxs)(n.em,{children:["(examples: ",(0,r.jsx)(n.a,{href:"https://github.com/thomaspoignant/go-feature-flag/tree/main/testdata/flag-config.yaml",children:(0,r.jsx)(n.code,{children:"YAML"})}),",\n",(0,r.jsx)(n.a,{href:"https://github.com/thomaspoignant/go-feature-flag/tree/main/testdata/flag-config.json",children:(0,r.jsx)(n.code,{children:"JSON"})}),",\n",(0,r.jsx)(n.a,{href:"https://github.com/thomaspoignant/go-feature-flag/tree/main/testdata/flag-config.toml",children:(0,r.jsx)(n.code,{children:"TOML"})}),")"]}),"."]}),"\n",(0,r.jsxs)(n.p,{children:["The easiest way to create your configuration file is to used\n",(0,r.jsxs)(n.a,{href:"https://thomaspoignant.github.io/go-feature-flag-editor/",children:[(0,r.jsx)(n.strong,{children:"GO Feature Flag Editor"})," available at https://thomaspoignant.github.io/go-feature-flag-editor/"]}),".",(0,r.jsx)(n.br,{}),"\n","If you prefer to do it manually please follow instruction bellow."]}),"\n",(0,r.jsx)(n.h2,{id:"editor",children:"Editor"}),"\n",(0,r.jsxs)(n.p,{children:["Creating the first version of the flag is not always pleasant, that's why we have created\n",(0,r.jsx)(n.a,{href:"https://thomaspoignant.github.io/go-feature-flag-editor/",children:(0,r.jsx)(n.strong,{children:"GO Feature Flag Editor"})})," a simple editor to create your files."]}),"\n",(0,r.jsx)(n.h2,{id:"example",children:"Example"}),"\n",(0,r.jsx)(n.p,{children:"A flag configuration looks like:"}),"\n",(0,r.jsx)(n.h3,{id:"yaml",children:"YAML"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:'test-flag:\n  percentage: 100\n  rule: key eq "random-key"\n  true: true\n  false: false\n  default: false\n  disable: false\n  trackEvents: true\n  version: 1\n  rollout:\n    experimentation:\n      start: 2021-03-20T00:00:00.10-05:00\n      end: 2021-03-21T00:00:00.10-05:00\n\ntest-flag2:\n  rule: key eq "not-a-key"\n  percentage: 100\n  true: true\n  false: false\n  default: false\n  version: 12\n'})}),"\n",(0,r.jsx)(n.h3,{id:"json",children:"JSON"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "test-flag": {\n    "percentage": 100,\n    "rule": "key eq \\"random-key\\"",\n    "true": true,\n    "false": false,\n    "default": false,\n    "disable": false,\n    "trackEvents": true,\n    "version": 1,\n    "rollout": {\n      "experimentation": {\n        "start": "2021-03-20T05:00:00.100Z",\n        "end": "2021-03-21T05:00:00.100Z"\n      }\n    }\n  },\n  "test-flag2": {\n    "rule": "key eq \\"not-a-key\\"",\n    "percentage": 100,\n    "true": true,\n    "false": false,\n    "default": false,\n    "version": 12\n  }\n}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"toml",children:"TOML"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-toml",children:'[test-flag]\npercentage = 100.0\nrule = "key eq \\"random-key\\""\ntrue = true\nfalse = false\ndefault = false\ndisable = false\ntrackEvents = true\nversion = 1.0\n\n[test-flag.rollout]\n\n    [test-flag.rollout.experimentation]\n    start = 2021-03-20T05:00:00.100Z\n    end = 2021-03-21T05:00:00.100Z\n\n[test-flag2]\nrule = "key eq \\"not-a-key\\""\npercentage = 100.0\ntrue = true\nfalse = false\ndefault = false\nversion = 12.0\n'})}),"\n",(0,r.jsx)(n.h2,{id:"format-details",children:"Format details"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{style:{textAlign:"center"},children:"Field"}),(0,r.jsx)(n.th,{children:"Description"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"center"},children:(0,r.jsx)(n.strong,{children:"flag-key"})}),(0,r.jsxs)(n.td,{children:["Name of your flag.",(0,r.jsx)("br",{})," It must be unique.",(0,r.jsx)("br",{}),(0,r.jsxs)(n.em,{children:["On the example the flag keys are ",(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.code,{children:"test-flag"})})," and ",(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.code,{children:"test-flag2"})}),"."]})]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"center"},children:(0,r.jsx)(n.code,{children:"true"})}),(0,r.jsxs)(n.td,{children:["Value returned by the flag if apply to the user ",(0,r.jsx)(n.em,{children:"(rule is evaluated to true)"})," and the user is in the active percentage."]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"center"},children:(0,r.jsx)(n.code,{children:"false"})}),(0,r.jsxs)(n.td,{children:["Value returned by the flag if apply to the user ",(0,r.jsx)(n.em,{children:"(rule is evaluated to true)"})," and the user is ",(0,r.jsx)(n.strong,{children:"not"})," in the active percentage."]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"center"},children:(0,r.jsx)(n.code,{children:"default"})}),(0,r.jsxs)(n.td,{children:["Value returned by the flag if not apply to the user ",(0,r.jsx)(n.em,{children:"(rule is evaluated to false)."})]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"center"},children:(0,r.jsx)(n.code,{children:"percentage"})}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.em,{children:"(optional)"}),(0,r.jsx)("br",{}),"Percentage of the users who should be affected by the flag.",(0,r.jsx)("br",{}),(0,r.jsx)(n.strong,{children:"Default: 0"}),(0,r.jsx)("br",{}),(0,r.jsx)("br",{}),"The percentage is computed by calculating a hash of the user key ",(0,r.jsx)(n.em,{children:"(100000 variations)"}),", it means that you can have 3 numbers after the comma."]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"center"},children:(0,r.jsx)(n.code,{children:"rule"})}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.em,{children:"(optional)"}),(0,r.jsx)("br",{}),"Condition to determine on which user the flag should be applied.",(0,r.jsx)("br",{}),"Rule format is described in the ",(0,r.jsx)(n.a,{href:"#rule-format",children:"rule format section"}),".",(0,r.jsx)("br",{}),(0,r.jsxs)(n.strong,{children:["If no rule is set, the flag applies to all users ",(0,r.jsx)(n.em,{children:"(percentage still apply)"}),"."]})]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"center"},children:(0,r.jsx)(n.code,{children:"disable"})}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.em,{children:"(optional)"}),(0,r.jsx)("br",{}),"True if the flag is disabled.",(0,r.jsx)("br",{}),(0,r.jsxs)(n.strong,{children:["Default: ",(0,r.jsx)(n.code,{children:"false"})]})]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"center"},children:(0,r.jsx)(n.code,{children:"trackEvents"})}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.em,{children:"(optional)"}),(0,r.jsx)("br",{}),"False if you don't want to export the data in your data exporter.",(0,r.jsx)("br",{}),(0,r.jsxs)(n.strong,{children:["Default: ",(0,r.jsx)(n.code,{children:"true"})]})]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"center"},children:(0,r.jsx)(n.code,{children:"version"})}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.em,{children:"(optional)"}),(0,r.jsx)("br",{}),"The version is the version of your flag.",(0,r.jsx)("br",{}),"This number is used to display the information in the notifiers and data collection, you have to update it your self.",(0,r.jsx)("br",{}),(0,r.jsx)(n.strong,{children:"Default: 0"})]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"center"},children:(0,r.jsx)(n.code,{children:"rollout"})}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.em,{children:"(optional)"}),(0,r.jsx)("br",{}),(0,r.jsx)("code",{children:"rollout"})," contains a specific rollout strategy you want to use.",(0,r.jsx)("br",{}),(0,r.jsxs)(n.strong,{children:["See ",(0,r.jsx)(n.a,{href:"/docs/v0.28.2/rollout/",children:"rollout section"})," for more details."]})]})]})]})]}),"\n",(0,r.jsx)(n.h2,{id:"rule-format",children:"Rule format"}),"\n",(0,r.jsxs)(n.p,{children:["The rule format is based on the ",(0,r.jsx)(n.a,{href:"https://github.com/nikunjy/rules",children:(0,r.jsx)(n.code,{children:"nikunjy/rules"})})," library."]}),"\n",(0,r.jsxs)(n.p,{children:["All the operations can be written capitalized or lowercase (ex: ",(0,r.jsx)(n.code,{children:"eq"})," or ",(0,r.jsx)(n.code,{children:"EQ"})," can be used).",(0,r.jsx)(n.br,{}),"\n","Logical Operations supported are ",(0,r.jsx)(n.code,{children:"AND"})," ",(0,r.jsx)(n.code,{children:"OR"}),"."]}),"\n",(0,r.jsxs)(n.p,{children:["Compare Expression and their definitions (",(0,r.jsx)(n.code,{children:"a|b"})," means you can use either one of the two ",(0,r.jsx)(n.code,{children:"a"})," or ",(0,r.jsx)(n.code,{children:"b"}),"):"]}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{style:{textAlign:"center"},children:"Operator"}),(0,r.jsx)(n.th,{children:"Description"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsxs)(n.td,{style:{textAlign:"center"},children:[(0,r.jsx)(n.code,{children:"eq"}),", ",(0,r.jsx)(n.code,{children:"=="})]}),(0,r.jsx)(n.td,{children:"equals to"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsxs)(n.td,{style:{textAlign:"center"},children:[(0,r.jsx)(n.code,{children:"ne"}),", ",(0,r.jsx)(n.code,{children:"!="})]}),(0,r.jsx)(n.td,{children:"not equals to"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsxs)(n.td,{style:{textAlign:"center"},children:[(0,r.jsx)(n.code,{children:"lt"}),", ",(0,r.jsx)(n.code,{children:"<"})]}),(0,r.jsx)(n.td,{children:"less than"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsxs)(n.td,{style:{textAlign:"center"},children:[(0,r.jsx)(n.code,{children:"gt"}),", ",(0,r.jsx)(n.code,{children:">"})]}),(0,r.jsx)(n.td,{children:"greater than"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsxs)(n.td,{style:{textAlign:"center"},children:[(0,r.jsx)(n.code,{children:"le"}),", ",(0,r.jsx)(n.code,{children:"<="})]}),(0,r.jsx)(n.td,{children:"less than equal to"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsxs)(n.td,{style:{textAlign:"center"},children:[(0,r.jsx)(n.code,{children:"ge"}),", ",(0,r.jsx)(n.code,{children:">="})]}),(0,r.jsx)(n.td,{children:"greater than equal to"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"center"},children:(0,r.jsx)(n.code,{children:"co"})}),(0,r.jsx)(n.td,{children:"contains"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"center"},children:(0,r.jsx)(n.code,{children:"sw"})}),(0,r.jsx)(n.td,{children:"starts with"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"center"},children:(0,r.jsx)(n.code,{children:"ew"})}),(0,r.jsx)(n.td,{children:"ends with"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"center"},children:(0,r.jsx)(n.code,{children:"in"})}),(0,r.jsx)(n.td,{children:"in a list"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"center"},children:(0,r.jsx)(n.code,{children:"pr"})}),(0,r.jsx)(n.td,{children:"present"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"center"},children:(0,r.jsx)(n.code,{children:"not"})}),(0,r.jsx)(n.td,{children:"not of a logical expression"})]})]})]}),"\n",(0,r.jsx)(n.h3,{id:"examples",children:"Examples"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Select a specific user: ",(0,r.jsx)(n.code,{children:'key eq "example@example.com"'})]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Select all identified users: ",(0,r.jsx)(n.code,{children:"anonymous ne true"})]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Select a user with a custom property: ",(0,r.jsx)(n.code,{children:'userId eq "12345"'})]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Select on multiple criteria:",(0,r.jsx)(n.br,{}),"\n",(0,r.jsxs)(n.em,{children:["All users with ids finishing by ",(0,r.jsx)(n.code,{children:"@test.com"})," that have the role ",(0,r.jsx)(n.code,{children:"backend engineer"})," in the ",(0,r.jsx)(n.code,{children:"pro"})," environment for the\ncompany ",(0,r.jsx)(n.code,{children:"go-feature-flag"})]})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'(key ew "@test.com") and (role eq "backend engineer") and (env eq "pro") and (company eq "go-feature-flag")`\n'})}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"environments",children:"Environments"}),"\n",(0,r.jsxs)(n.p,{children:["When you initialise ",(0,r.jsx)(n.code,{children:"go-feature-flag"})," you can set an environment for the instance of this SDK."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-go",metastring:'linenums="1"',children:'ffclient.Init(ffclient.Config{ \n    // ...\n    Environment:    "prod",\n    // ...\n})\n'})}),"\n",(0,r.jsxs)(n.p,{children:["When an environment is set, it adds a new field in your user called ",(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.code,{children:"env"})})," that you can use in your rules.",(0,r.jsx)(n.br,{}),"\n","It means that you can decide to activate a flag only for some ",(0,r.jsx)(n.strong,{children:"environment"}),"."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Example of rules based on the environment:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:'# Flag activate only in dev\nrule: env == "dev"\n'})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:'# Flag used only in dev and staging environment\nrule: (env == "dev") or (env == "staging")\n'})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:'# Flag used on non prod environments except for the user 1234 in prod\nrule: (env != "prod") or (user_id == 1234)\n'})}),"\n",(0,r.jsx)(n.h2,{id:"advanced-configurations",children:"Advanced configurations"}),"\n",(0,r.jsx)(n.p,{children:"You can have advanced configurations for your flag to have specific behavior for them, such as:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"/docs/v0.28.2/rollout/",children:"Specific rollout strategies"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"/docs/v0.28.2/data_collection/#dont-track-a-flag",children:"Don't track a flag"})}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,s.a)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}},11151:(e,n,t)=>{t.d(n,{Z:()=>a,a:()=>i});var r=t(67294);const s={},l=r.createContext(s);function i(e){const n=r.useContext(l);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:i(e.components),r.createElement(l.Provider,{value:n},e.children)}}}]);